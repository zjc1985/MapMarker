<!DOCTYPE html>  
<html>  
<head>  
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<style type="text/css">  
body, html,#allmap {width: 100%;height: 100%;}

#searchDialog{
	position: absolute;
  	left: 30px;
  	top: 20px;
  	z-index:3;
}

.info{
	position: absolute;
  	z-index:2;
  	background-color: white;
  	border-style: groove;
  	border-width: 1px;
  	width:450px;
  	height:130px;
  	padding: 5px;
  	top:70px;
  	left:30px;
}


</style>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
<link rel="stylesheet" href="js/lib/magnific-popup.css">

<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=DAfc49ea71a7aff2f10ac4847a9208d0"></script>
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="js/lib/jquery.magnific-popup.js"></script>
<script src="js/InfoCard.js"></script> 
<title>Style Testing</title>  
</head>  
<body>

<div id="searchDialog">
		<input type="text" name="searchKey" id="searchKey" size="50" style="height:25px;"/>
		<input type="button" value="search" onclick="searchLocation()" style="height:30px"/>
		<input type="button" value="feature" onclick="feature()" style="height:30px"/>
</div>

<div id="allmap"></div>  



<div id="customInfoA">
	<div class="popup-gallery" id="12">
		<a href="resource/img/wuzheng/wu1.png" title="The Cleaner">
			<div style='background-image: url(resource/img/wuzheng/wu1.png);height:80px;background-position: center;'>
				<p style='color:white;opacity:0.55;background-color: black;'>乌镇</p>
			</div>
		</a>
		<a style='display: none;' href="http://farm9.staticflickr.com/8382/8558295631_0f56c1284f_b.jpg" title="Winter Dance"></a>
		<a style='display: none;' href="http://farm9.staticflickr.com/8225/8558295635_b1c5ce2794_b.jpg" title="The Uninvited Guest"></a>
		<a style='display: none;' href="http://farm9.staticflickr.com/8383/8563475581_df05e9906d_b.jpg" title="Oh no, not again!"></a>
	</div>
</div>

<div id="customInfoB">
	<p>This is Custom Basic Info. This is Custom Info</p>
</div>

<div id='titleInfoA'>	
	<h2 id='title'>Title</h2>
	<p id='address'>This is one address.</p>	
	<div style='position:absolute;top:20px;left:300px' id='favorite'>
		<img src='resource/favorite.png' height='120px'/>
	</div>
</div>

<div id="titleInfoB">	
	<p id="titleIntro">This is Basic Info. This is Basic Info</p>
</div>


<div id='gallery' style='background-image: url(resource/img/wuzheng/wu1.png);height:80px;background-position: center;'>
		<p style='color:white;opacity:0.55;background-color: black;'>乌镇</p>
</div>

</body>  
</html>  
<script type="text/javascript">
var map = new BMap.Map("allmap");
var point = new BMap.Point(116.404, 39.915);
map.centerAndZoom(point, 15);
map.enableScrollWheelZoom();

$("#titleInfoA").hide();
$("#titleInfoB").hide();
$("#customInfoA").hide();
$("#customInfoB").hide();

var t=new infoCard("card",createTitleContentA("TrainStation","XianXia Road"),
		createBasicInfo("基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述这是基本描述"));
t.init("70px","30px");


var imgGalleryHtml=createImgGallery([
        {url:'resource/img/wuzheng/wu1.png',title:'Wu Zheng'},
        {url:'http://farm9.staticflickr.com/8382/8558295631_0f56c1284f_b.jpg',title:'P2'},
        {url:'http://farm9.staticflickr.com/8383/8563475581_df05e9906d_b.jpg',title:'P3'}
                                 ],"乌镇");


var i=new infoCard("img",imgGalleryHtml,$("#customInfoB").html());
i.init("200px","30px");

$('.popup-gallery').magnificPopup({
	delegate: 'a',
	type: 'image',
	tLoading: 'Loading image #%curr%...',
	//mainClass: 'mfp-img-mobile',
	gallery: {
		enabled: true,
		navigateByImgClick: true,
		preload: [0,1] // Will preload 0 - before current, and 1 after the current image
	},
	image: {
		tError: '<a href="%url%">The image #%curr%</a> could not be loaded.',
		titleSrc: function(item) {
			return item.el.attr('title');
		}
	}
});


function createTitleContentA(title,address){
	return "<div><h2>"+title+"</h2><p>"+address+"</p>	<div style='position:absolute;top:20px;left:300px' id='favorite'><img src='resource/favorite.png' height='120px'/></div></div>";
}



function createBasicInfo(content){
	return "<p style='text-overflow:ellipsis;height:70px'>"+content+"</p>";
}

function createImgGallery(imgArray,mainTitle){
	var ahrefs="";
	
	for(var index in imgArray){
		if(index==0){
			ahrefs=	"<a href='"+imgArray[0].url+"' title='"+imgArray[0].title+"'><div style='background-image: url("+imgArray[0].url+");height:80px;background-position: center;'><p style='color:white;opacity:0.55;background-color: black;'>"+mainTitle+"</p></div></a>";
		}else{
			ahrefs+="<a style='display: none;' href='"+imgArray[index].url+"' title='"+imgArray[index].title+"'></a>";
		}
	}
	
	
	var html="<div><div class='popup-gallery'>"+ahrefs+"</div></div>";
	return html;
	
}

function feature(){
	$(".info").show();
	t.resetLocation("70px","30px");
	i.resetLocation("200px","30px");
	
	createImgGallery([
	    {
		url:'url1',
		title:'title1'
		},
		{
		url:'url2',
		title:'title2'
		},
	
	]);
}
</script>  